<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" id="dynamic-favicon" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="dynamic-title">deepwn.github.io</title>
    <script>
      // Get favicon MIME type based on file extension
      function getFaviconMimeType(url) {
        const extension = url.split('.').pop()?.toLowerCase();
        const mimeTypes = {
          svg: 'image/svg+xml',
          png: 'image/png',
          ico: 'image/x-icon',
          jpg: 'image/jpeg',
          jpeg: 'image/jpeg',
          gif: 'image/gif',
          webp: 'image/webp',
        };
        return mimeTypes[extension] || 'image/x-icon';
      }

      // Fetch config and update page title and favicon
      fetch('/config.json')
        .then(r => r.json())
        .then(config => {
          // Support both flat structure (config.website) and nested structure (config.site.website)
          const websiteConfig = config.website || config.site?.website;

          if (websiteConfig) {
            if (websiteConfig.title) {
              document.title = websiteConfig.title;
            }
            if (websiteConfig.favicon) {
              const faviconLink = document.getElementById('dynamic-favicon');
              if (faviconLink) {
                faviconLink.setAttribute('href', websiteConfig.favicon);
                faviconLink.setAttribute('type', getFaviconMimeType(websiteConfig.favicon));
              }
            }
          }
        })
        .catch(() => {
          // Silently fail - keep default values
        });
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
